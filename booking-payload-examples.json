{
  "description": "POST /api/marketplace/bookings - Request Payload Examples",
  "endpoint": "POST /api/marketplace/bookings",
  "access": "Private (requires authentication)",
  "contentType": "application/json",
  
  "note": "The endpoint accepts data in two formats: direct body or nested formData structure",
  
  "format1_directBody": {
    "description": "Direct body format (preferred)",
    "example": {
      "serviceId": "6925524813fca6eaba97fe64",
      "providerId": "691c5e67d2d77a123ad8bfeb",
      "bookingDate": "2025-12-28",
      "bookingTime": "02:36",
      "duration": 1,
      "paymentMethod": "paypal",
      "address": {
        "street": "123 Main Street",
        "city": "New York",
        "state": "NY",
        "zipCode": "10001",
        "country": "US",
        "coordinates": {
          "lat": 40.7128,
          "lng": -74.0060
        }
      },
      "specialInstructions": "Please ring doorbell twice"
    }
  },

  "format2_nestedFormData": {
    "description": "Nested formData format (also supported)",
    "example": {
      "serviceId": "6925524813fca6eaba97fe64",
      "providerId": "691c5e67d2d77a123ad8bfeb",
      "formData": {
        "bookingDate": "2025-12-28",
        "bookingTime": "02:36",
        "duration": 1,
        "paymentMethod": "paypal",
        "address": {
          "street": "123 Main Street",
          "city": "New York",
          "state": "NY",
          "zipCode": "10001",
          "country": "US",
          "coordinates": {
            "lat": 40.7128,
            "lng": -74.0060
          }
        },
        "specialInstructions": "Please ring doorbell twice"
      }
    }
  },

  "fieldDescriptions": {
    "serviceId": {
      "type": "string (MongoDB ObjectId)",
      "required": true,
      "description": "The ID of the service to book",
      "example": "6925524813fca6eaba97fe64"
    },
    "providerId": {
      "type": "string (MongoDB ObjectId)",
      "required": false,
      "description": "Optional provider ID for validation. If provided, must match the service's provider",
      "example": "691c5e67d2d77a123ad8bfeb"
    },
    "bookingDate": {
      "type": "string",
      "required": true,
      "format": "YYYY-MM-DD or ISO 8601 datetime string",
      "description": "The date for the booking. Can be just date (YYYY-MM-DD) or full ISO datetime",
      "examples": ["2025-12-28", "2025-12-28T14:00:00Z"]
    },
    "bookingTime": {
      "type": "string",
      "required": false,
      "format": "HH:MM (24-hour format)",
      "description": "The time for the booking. Required if bookingDate is just a date",
      "examples": ["02:36", "14:30", "09:00"]
    },
    "duration": {
      "type": "number",
      "required": true,
      "description": "Duration of the service in hours. Must be a positive number",
      "examples": [1, 2, 3.5, 4]
    },
    "paymentMethod": {
      "type": "string",
      "required": false,
      "default": "cash",
      "enum": ["cash", "card", "bank_transfer", "paypal", "paymaya", "paymongo"],
      "description": "Payment method for the booking. If 'paypal', a PayPal order will be created and approval URL returned"
    },
    "address": {
      "type": "object",
      "required": false,
      "description": "Service location address",
      "properties": {
        "street": "string - Street address",
        "city": "string - City name",
        "state": "string - State or province",
        "zipCode": "string - Postal/ZIP code",
        "country": "string - Country code or name",
        "coordinates": {
          "lat": "number - Latitude (-90 to 90)",
          "lng": "number - Longitude (-180 to 180)"
        }
      }
    },
    "specialInstructions": {
      "type": "string",
      "required": false,
      "description": "Any special instructions for the service provider"
    }
  },

  "minimalExample": {
    "description": "Minimal required fields only",
    "payload": {
      "serviceId": "6925524813fca6eaba97fe64",
      "bookingDate": "2025-12-28",
      "bookingTime": "14:00",
      "duration": 2
    }
  },

  "fullExample": {
    "description": "All fields included",
    "payload": {
      "serviceId": "6925524813fca6eaba97fe64",
      "providerId": "691c5e67d2d77a123ad8bfeb",
      "bookingDate": "2025-12-28",
      "bookingTime": "14:30",
      "duration": 3,
      "paymentMethod": "paypal",
      "address": {
        "street": "456 Oak Avenue",
        "city": "Los Angeles",
        "state": "CA",
        "zipCode": "90001",
        "country": "US",
        "coordinates": {
          "lat": 34.0522,
          "lng": -118.2437
        }
      },
      "specialInstructions": "Please use eco-friendly products. Ring doorbell twice. Park in driveway."
    }
  },

  "dateTimeFormats": {
    "note": "The endpoint accepts multiple date/time formats",
    "format1": {
      "description": "Separate date and time",
      "bookingDate": "2025-12-28",
      "bookingTime": "14:30"
    },
    "format2": {
      "description": "ISO datetime string",
      "bookingDate": "2025-12-28T14:30:00Z"
    },
    "format3": {
      "description": "ISO datetime with timezone",
      "bookingDate": "2025-12-28T14:30:00-05:00"
    }
  },

  "validationRules": {
    "serviceId": "Must be a valid MongoDB ObjectId",
    "bookingDate": "Required. Must be at least 5 minutes in the future",
    "duration": "Required. Must be a positive number (hours)",
    "paymentMethod": "Must be one of: cash, card, bank_transfer, paypal, paymaya, paymongo",
    "bookingTime": "If provided, must be in HH:MM format (24-hour)"
  },

  "responseExample": {
    "success": true,
    "message": "Booking created successfully",
    "data": {
      "booking": {
        "_id": "64a1b2c3d4e5f6789012345",
        "service": {
          "_id": "6925524813fca6eaba97fe64",
          "title": "Professional House Cleaning",
          "category": "cleaning",
          "pricing": {
            "type": "hourly",
            "basePrice": 25,
            "currency": "USD"
          }
        },
        "client": {
          "_id": "64a1b2c3d4e5f6789012346",
          "firstName": "John",
          "lastName": "Doe",
          "email": "john@example.com"
        },
        "provider": {
          "_id": "691c5e67d2d77a123ad8bfeb",
          "firstName": "Jane",
          "lastName": "Smith",
          "email": "jane@example.com",
          "profile": {
            "businessName": "Clean Pro Services"
          }
        },
        "bookingDate": "2025-12-28T14:30:00.000Z",
        "duration": 3,
        "address": {
          "street": "456 Oak Avenue",
          "city": "Los Angeles",
          "state": "CA",
          "zipCode": "90001",
          "country": "US",
          "coordinates": {
            "lat": 34.0522,
            "lng": -118.2437
          }
        },
        "specialInstructions": "Please use eco-friendly products",
        "status": "pending",
        "pricing": {
          "basePrice": 25,
          "totalAmount": 75,
          "currency": "USD"
        },
        "payment": {
          "method": "paypal",
          "status": "pending",
          "paypalOrderId": "5O190127TN364715T"
        },
        "timeline": [
          {
            "status": "pending",
            "timestamp": "2025-12-23T17:37:07.573Z",
            "note": "Booking created",
            "updatedBy": "64a1b2c3d4e5f6789012346"
          }
        ],
        "createdAt": "2025-12-23T17:37:07.573Z",
        "updatedAt": "2025-12-23T17:37:07.573Z"
      },
      "paypalApprovalUrl": "https://www.sandbox.paypal.com/checkoutnow?token=5O190127TN364715T"
    }
  },

  "errorExamples": {
    "missingServiceId": {
      "status": 400,
      "body": {
        "success": false,
        "message": "Validation error",
        "code": "VALIDATION_ERROR",
        "errors": [
          {
            "field": "serviceId",
            "message": "Service ID is required",
            "code": "SERVICE_ID_REQUIRED"
          }
        ]
      }
    },
    "invalidDate": {
      "status": 400,
      "body": {
        "success": false,
        "message": "Validation error",
        "code": "VALIDATION_ERROR",
        "errors": [
          {
            "field": "bookingDate",
            "message": "Booking date must be at least 5 minutes in the future",
            "code": "BOOKING_DATE_INVALID"
          }
        ]
      }
    },
    "serviceNotFound": {
      "status": 404,
      "body": {
        "success": false,
        "message": "Service not found",
        "code": "SERVICE_NOT_FOUND"
      }
    },
    "bookingConflict": {
      "status": 409,
      "body": {
        "success": false,
        "message": "Service already booked for this time slot",
        "code": "BOOKING_CONFLICT"
      }
    }
  }
}

